<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="hamster" />
    <script type="text/javascript" src="file:///usr/share/javascript/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="file:///usr/share/javascript/jquery-ui/jquery-ui.min.js"></script>
    <link type="text/css" href="file:///usr/share/javascript/jquery-ui/themes/base/jquery-ui.min.css" rel="stylesheet" />


    <title>Activity report for April 06 – 10, 2021</title>
    <style type="text/css">
        body {
            font-family: "Droid Sans", "Liberation Sans", "Helvetica", "Arial", sans-serif;
            font-size: 12px;
            padding: 0;
            margin: 0;
            color: #303030;
            background: #eee;
        }

        #content {
            width: 700px;
            padding:  24px 12px;
            margin:0px auto;
            background: #f6f6f6;
            border-right: 2px solid #bbb;
            border-left: 1px solid #bbb;
        }

        th, td {
            text-align: left;
            padding-right: 24px;
        }

        th {
            padding-top: 12px;
        }

        h1 {margin-top: 0; margin-bottom: 1em;}
        h2 {margin-bottom: 4px;}

        .even {background-color: #eee;}
        .odd {background-color: #fff;}

        .by_day_controls {
            margin-bottom: 24px;
        }

        #activity_log {
            display: none;
        }


        table.chart {
            border-collapse:collapse;
            margin-bottom: 2em;
        }

        td.bar_col {
            width: 100px;
        }

        .bar {
            background-color: #7B8ED7;
            border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
            color: #fff;
            height: 100%;
        }

        #date_chart {
            width: 100%;
            overflow: auto;
            overflow-y: hidden;
            height: 80px;
        }

        #date_chart table {
            width: 100%;
            height: 90%;
            border-collapse: collapse;
            margin-bottom: 4px;
        }

        #date_chart table tr {vertical-align: bottom;}
        #date_chart table td {
            padding: 0;
            padding-right: 1px;
        }

        #date_chart .bar {
            width: 100%;
            background-color: #ccc;
            border-radius: 0;
            border-top-left-radius: 2px;
            border-top-right-radius: 2px;
        }

        #grand_total {
            color: #999;
        }

        #activity_log {
            padding: 6px;
            margin: 6px;
            padding-left: 12px;
            border: 1px solid silver;
            background: #eee;

        }

        #date_facts tr:td {
            padding-left: 24px;
        }

        p.template-instructions {
            margin-top: 2em;
        }
    </style>

    <style type="text/css" media="print">
        div#tabs ul {
            display: none;
        }

        div#tabs {
            border: none;
        }

        div.by_day_controls {
            display: none;
        }

        p.template-instructions {
            display: none;
        }
    </style>

    <script type="text/javascript">
        var facts = [{"id": 422, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617667200, "start_time": 1617701580, "end_time": 1617705780, "delta": 4200.0}, {"id": 428, "activity": "meeting", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617706800, "end_time": 1617710400, "delta": 3600.0}, {"id": 426, "activity": "dojo", "category": "Labs", "description": "", "tags": [], "date": 1617667200, "start_time": 1617714000, "end_time": 1617717600, "delta": 3600.0}, {"id": 427, "activity": "vincent", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617717600, "end_time": 1617719100, "delta": 1500.0}, {"id": 429, "activity": "veille", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617719400, "end_time": 1617723420, "delta": 4020.0}, {"id": 431, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617667200, "start_time": 1617725640, "end_time": 1617731160, "delta": 5520.0}, {"id": 432, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617667200, "start_time": 1617732300, "end_time": 1617735540, "delta": 3240.0}, {"id": 433, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617786300, "end_time": 1617789600, "delta": 3300.0}, {"id": 434, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617789600, "end_time": 1617796200, "delta": 6600.0}, {"id": 437, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617796200, "end_time": 1617797700, "delta": 1500.0}, {"id": 436, "activity": "guillaume", "category": "Mgmt", "description": "", "tags": [], "date": 1617753600, "start_time": 1617804600, "end_time": 1617806940, "delta": 2340.0}, {"id": 438, "activity": "formation", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617807120, "end_time": 1617810420, "delta": 3300.0}, {"id": 439, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617810420, "end_time": 1617811560, "delta": 1140.0}, {"id": 440, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617814140, "end_time": 1617822060, "delta": 7920.0}, {"id": 441, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617840000, "start_time": 1617873720, "end_time": 1617875160, "delta": 1440.0}, {"id": 442, "activity": "blog", "category": "Cse", "description": "", "tags": [], "date": 1617840000, "start_time": 1617875160, "end_time": "", "delta": 0.0}];

        function showChart(target, data) {
            totals = []
            // turn object into a list of tuples and convert durations from seconds to hours
            var max_duration = 0;
            for (var key in data) {
                var duration = data[key] / 60 / 60.0;
                totals.push([key, duration]); // hours

                max_duration = Math.max(max_duration, duration);
            }

            // sort by duration descending
            totals.sort(function compare(a,b) {return b[1] - a[1]})

            // create the HTML
            var table = $("<table class='chart' style='width:100%' />")
            for (var i=0; i < totals.length; i++) {
                var total = totals[i];

                var row = $("<tr />");
                var label = $("<td />");

                label.text(total[0]);
                row.append(label);


                var duration = Math.round(total[1] * 10) / 10; // round to one decimal
                var duration_label = $("<td />");
                duration_label.text(duration);
                row.append(duration_label);


                var bar_col = $("<td class='bar_col' />");
                var bar = $("<div class='bar'>&nbsp;</div>");
                bar.width(total[1] / max_duration * 100);
                bar_col.append(bar);
                row.append(bar_col);

                table.append(row);
            }

            target.append(table);

        }

        $(document).ready(function() {
            var categoryTotals = {};
            var activityTotals = {};
            var tagTotals = {};
            var dateTotals = {}

            function add(list, key, value) {
                list[key] = list[key] || 0;
                list[key] += value;
            }

            var grandTotal = 0;
            for (var i=0; i < facts.length; i++) {
                var fact = facts[i];

                add(dateTotals, fact.date, fact.delta)
                add(categoryTotals, fact.category, fact.delta)
                add(activityTotals, fact.activity, fact.delta)

                for (var j=0; j < fact.tags.length; j++) {
                    add(tagTotals, fact.tags[j], fact.delta)
                }

                grandTotal += fact.delta;
            }

            grandTotal = Math.round(grandTotal / 60 / 60 * 10) / 10;
            $("#grand_total").text("(" + grandTotal + ")");



            showChart($("#category_chart"), categoryTotals)
            showChart($("#activity_chart"), activityTotals)
            showChart($("#tag_chart"), tagTotals)


            // create the by-day chart
            var startDate = 1617667200;
            var endDate = 1618012800;

            var dates = [];
            var dateMax = 0;
            for (var i=startDate; i <= endDate; i += 24 * 60 * 60) {
                var duration = dateTotals[i] || 0;
                dateMax = Math.max(dateMax, duration);
                dates.push([new Date(i), duration])
            }

            var table = $("<table />")
            var row = $("<tr />");
            for (var i=0; i<dates.length; i++) {
                var date = dates[i];
                var col = $("<td />");

                var bar = $("<div class='bar'>&nbsp;</div>");
                var bar_height = date[1] / dateMax * 70;
                if (bar_height < 1)
                    bar.height(1);
                else
                    bar.height(bar_height)

                col.append(bar);
                row.append(col);
            }
            table.append(row);
            $("#date_chart").append(table);



            $("#activity_log_link").click(function() {
                $("#activity_log").toggle();
                return false;
            })

            $("#show_details").click(function() {
                if ($(this).attr("checked")) {
                    $(".by_date_row").show();
                } else {
                    $(".by_date_row").hide();
                }

            })

            $("#show_totals").click(function() {
                if ($(this).attr("checked")) {
                    $(".by_date_total_row").show();
                } else {
                    $(".by_date_total_row").hide();
                }


            })

            populateFactTable();


            $(".by_day_controls input").click(function(){
                populateFactTable();
            });
        });


        function populateFactTable() {
            // fill fact rows
            var table = $("#date_facts");
            table.empty();

            var dateFacts = [["Apr 06, 2021", [{"id": 422, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617667200, "start_time": 1617701580, "end_time": 1617705780, "delta": 4200.0}, {"id": 428, "activity": "meeting", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617706800, "end_time": 1617710400, "delta": 3600.0}, {"id": 426, "activity": "dojo", "category": "Labs", "description": "", "tags": [], "date": 1617667200, "start_time": 1617714000, "end_time": 1617717600, "delta": 3600.0}, {"id": 427, "activity": "vincent", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617717600, "end_time": 1617719100, "delta": 1500.0}, {"id": 429, "activity": "veille", "category": "Mgmt", "description": "", "tags": [], "date": 1617667200, "start_time": 1617719400, "end_time": 1617723420, "delta": 4020.0}, {"id": 431, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617667200, "start_time": 1617725640, "end_time": 1617731160, "delta": 5520.0}, {"id": 432, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617667200, "start_time": 1617732300, "end_time": 1617735540, "delta": 3240.0}]], ["Apr 07, 2021", [{"id": 433, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617786300, "end_time": 1617789600, "delta": 3300.0}, {"id": 434, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617789600, "end_time": 1617796200, "delta": 6600.0}, {"id": 437, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617796200, "end_time": 1617797700, "delta": 1500.0}, {"id": 436, "activity": "guillaume", "category": "Mgmt", "description": "", "tags": [], "date": 1617753600, "start_time": 1617804600, "end_time": 1617806940, "delta": 2340.0}, {"id": 438, "activity": "formation", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617807120, "end_time": 1617810420, "delta": 3300.0}, {"id": 439, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617753600, "start_time": 1617810420, "end_time": 1617811560, "delta": 1140.0}, {"id": 440, "activity": "dev", "category": "Bookadesk", "description": "", "tags": [], "date": 1617753600, "start_time": 1617814140, "end_time": 1617822060, "delta": 7920.0}]], ["Apr 08, 2021", [{"id": 441, "activity": "lead", "category": "Aiintense", "description": "", "tags": [], "date": 1617840000, "start_time": 1617873720, "end_time": 1617875160, "delta": 1440.0}, {"id": 442, "activity": "blog", "category": "Cse", "description": "", "tags": [], "date": 1617840000, "start_time": 1617875160, "end_time": "", "delta": 0.0}]], ["Apr 09, 2021", []], ["Apr 10, 2021", []]];

            // determine if we will be doing any internal counting
            var keys = [];
            if ($("#show_activities").attr("checked"))
                keys.push("activity");

            if ($("#show_categories").attr("checked"))
                keys.push("category");

            if ($("#show_tags").attr("checked"))
                keys.push("tags");



            for (var i in dateFacts) {
                var dateString = dateFacts[i][0];
                var dateTotal = 0;

                var factTotals = {}
                for (var j in dateFacts[i][1]) {
                    var fact = dateFacts[i][1][j];
                    fact.tags = fact.tags.join(", ");

                    if (keys.length > 0) {
                        var key = [];
                        for (var k in keys) {
                            key.push(fact[keys[k]])
                        }

                        key = key.join(" - ");
                        factTotals[key] = factTotals[key] || 0;
                        factTotals[key] += fact.delta;
                    }


                    dateTotal += fact.delta;
                }

                dateTotal = Math.round(dateTotal / 60 / 60 * 10) / 10;
                table.append("<tr><th>" + dateString + "</th><th>" + dateTotal +"</th></tr>");

                for (var key in factTotals) {
                    keyTotal = Math.round(factTotals[key] / 60 / 60 * 10) / 10;
                    table.append("<tr><td>" + key + "</td><td>" + keyTotal +"</td></tr>");
                }


            }
        }
    </script>
</head>
<body>

<div id="content">
    <h1>Activity report for April 06 – 10, 2021 <span id="grand_total"></span></h1>

    <div id="date_chart"></div>

    <a id="activity_log_link" href="#">Show activity log</a>
    <div id="activity_log">
        <h2>Activity Log</h2>
        <table>
            <tr>
                <th>Date</th>
                <th>Activity</th>
                <th>Category</th>
                <th>Tags</th>
                <th>Start</th>
                <th>End</th>
                <th>Duration</th>
                <th>Description</th>
            </tr>
            
                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>lead</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        09:33
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        10:43
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h 10min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>meeting</td>
                    <td>Mgmt</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        11:00
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        12:00
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>dojo</td>
                    <td>Labs</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        13:00
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        14:00
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>vincent</td>
                    <td>Mgmt</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        14:00
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        14:25
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        25min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>veille</td>
                    <td>Mgmt</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        14:30
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        15:37
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h 7min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>lead</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        16:14
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        17:46
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h 32min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 06, 2021
                    </td>
                    <td>dev</td>
                    <td>Bookadesk</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        18:05
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        18:59
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        54min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>dev</td>
                    <td>Bookadesk</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        09:05
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        10:00
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        55min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>lead</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        10:00
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        11:50
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        1h 50min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>dev</td>
                    <td>Bookadesk</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        11:50
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        12:15
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        25min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>guillaume</td>
                    <td>Mgmt</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        14:10
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        14:49
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        39min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>formation</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        14:52
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        15:47
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        55min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>lead</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        15:47
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        16:06
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        19min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 07, 2021
                    </td>
                    <td>dev</td>
                    <td>Bookadesk</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        16:49
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        19:01
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        2h 12min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 08, 2021
                    </td>
                    <td>lead</td>
                    <td>Aiintense</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        09:22
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        09:46
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        24min
                    </td>
                    <td></td>
                </tr>
            

                <tr>
                    <td>
                        <!-- there is also date_iso -->
                        Apr 08, 2021
                    </td>
                    <td>blog</td>
                    <td>Cse</td>
                    <td></td>
                    <td>
                        <!-- there is also start_iso -->
                        09:46
                    </td>
                    <td>
                        <!-- there is also end_iso -->
                        
                    </td>
                    <td>
                        <!-- there is also duration_decimal and duration_minutes -->
                        0h
                    </td>
                    <td></td>
                </tr>
            
        </table>
    </div>



    <table>
        <tr style="vertical-align: top">
            <td style="width: 100%">

                <h2>Totals by Day</h2>

                <div class="by_day_controls">
                    Distinguish:
                    <input type="checkbox" id="show_activities" checked="checked"></input>
                    <label for="show_details">activities</label>

                    <input type="checkbox" id="show_categories" checked="checked"></input>
                    <label for="show_totals">categories</label>

                    <input type="checkbox" id="show_tags" checked="checked"></input>
                    <label for="show_totals">tags</label>
                </div>

                <table id="date_facts"></table>
            </td>
            <td>
                <div>
                    <h2>Categories</h2>
                    <div id="category_chart"></div>
                </div>
                <div>
                    <h2>Activities</h2>
                    <div id="activity_chart"></div>
                </div>
                <div>
                    <h2>Tags</h2>
                    <div id="tag_chart"></div>
                </div>
            </td>
        </tr>
    </table>



    <p class="template-instructions">
        <a href="file:////usr/share/hamster/report_template.html">Show template</a>.
        You can override it by storing your version in /home/nico/.local/share/hamster.
    </p>
</div>
</body>
</html>

